{% extends "base.html" %}
{% block title %}Pesquisar Veículos - Luxury Wheels{% endblock %}
{% block content %}

<div class="search-section fade-in">
  <h2><i class="bi bi-search"></i> Encontre Seu Veículo Ideal</h2>
  
  <form method="GET" action="/search" class="row g-3">
    <div class="col-md-3">
      <label class="form-label"><i class="bi bi-tag"></i> Marca</label>
      <input name="brand" class="form-control" placeholder="Ex: Mercedes, BMW..." value="{{ request.args.get('brand', '') }}">
    </div>
    
    <div class="col-md-3">
      <label class="form-label"><i class="bi bi-grid"></i> Categoria</label>
      <input name="category" class="form-control" placeholder="Ex: Esportivo, SUV..." value="{{ request.args.get('category', '') }}">
    </div>
    
    <div class="col-md-3">
      <label class="form-label"><i class="bi bi-car-front"></i> Tipo</label>
      <select name="vehicle_type" class="form-select">
        <option value="">Todos</option>
        <option value="Carro" {% if request.args.get('vehicle_type') == 'Carro' %}selected{% endif %}>Carro</option>
        <option value="Moto" {% if request.args.get('vehicle_type') == 'Moto' %}selected{% endif %}>Moto</option>
      </select>
    </div>
    
    <div class="col-md-3">
      <label class="form-label"><i class="bi bi-cash"></i> Valor máximo (€)</label>
      <input name="max_price" type="number" step="0.01" class="form-control" placeholder="500.00" value="{{ request.args.get('max_price', '') }}">
    </div>
    
    <div class="col-md-4">
      <label class="form-label"><i class="bi bi-calendar-event"></i> Data início</label>
      <input name="start_date" type="date" class="form-control" value="{{ request.args.get('start_date', '') }}">
    </div>
    
    <div class="col-md-4">
      <label class="form-label"><i class="bi bi-calendar-check"></i> Data fim</label>
      <input name="end_date" type="date" class="form-control" value="{{ request.args.get('end_date', '') }}">
    </div>
    
    <div class="col-md-4 d-flex align-items-end">
      <button type="submit" class="btn btn-primary w-100">
        <i class="bi bi-search"></i> Pesquisar
      </button>
    </div>
  </form>
</div>

<div class="mb-3">
  <h3 class="mb-4">
    <i class="bi bi-car-front-fill"></i> Veículos Disponíveis
    <span class="badge bg-primary">{{ vehicles|length }}</span>
  </h3>
</div>

{% if vehicles %}
  <div class="row">
    {% for vehicle in vehicles %}
      <div class="col-md-4 mb-4 scroll-reveal">
        <div class="card h-100 fade-in card-3d" style="position: relative;">
          <div class="vehicle-badge">
            {{ "%.0f"|format(vehicle.daily_rate) }}€/dia
          </div>
          
          {% if vehicle.image_url %}
            <img src="{{ vehicle.image_url }}" class="card-img-top" alt="{{ vehicle.brand }} {{ vehicle.model }}" onerror="this.src='https://via.placeholder.com/400x220?text=Sem+Imagem'">
          {% else %}
            <img src="https://via.placeholder.com/400x220?text={{ vehicle.brand }}+{{ vehicle.model }}" class="card-img-top" alt="Placeholder">
          {% endif %}
          
          <div class="card-body">
            <h5 class="card-title">
              <i class="bi bi-star-fill" style="color: var(--gold-color);"></i>
              {{ vehicle.brand }} {{ vehicle.model }}
            </h5>
            
            <ul class="vehicle-info">
              <li>
                <span><i class="bi bi-car-front"></i> <strong>Tipo:</strong></span>
                <span class="badge bg-secondary">{{ vehicle.vehicle_type }}</span>
              </li>
              <li>
                <span><i class="bi bi-gear"></i> <strong>Transmissão:</strong></span>
                <span>{{ vehicle.transmission }}</span>
              </li>
              <li>
                <span><i class="bi bi-people"></i> <strong>Capacidade:</strong></span>
                <span>{{ vehicle.people_capacity }} pessoas</span>
              </li>
              {% if vehicle.category %}
              <li>
                <span><i class="bi bi-tags"></i> <strong>Categoria:</strong></span>
                <span class="badge bg-info">{{ vehicle.category }}</span>
              </li>
              {% endif %}
            </ul>
            
            <div class="d-grid gap-2 mt-3">
              <a href="/reserve?vehicle_id={{ vehicle.id }}" class="btn btn-success ripple">
                <i class="bi bi-calendar-check"></i> Reservar Agora
              </a>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="empty-state">
    <i class="bi bi-search"></i>
    <h4>Nenhum veículo encontrado</h4>
    <p>Tente ajustar os filtros de pesquisa</p>
  </div>
{% endif %}

{% endblock %}
